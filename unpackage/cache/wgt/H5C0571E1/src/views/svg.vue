<template>
  <view>
    <svg
      width="1280"
      height="720"
      viewBox="0 0 1280 720"
      xmlns="http://www.w3.org/2000/svg"
      xmlns:xlink="http://www.w3.org/1999/xlink"
    >
      <g>
        <path
          v-for="(i, t) of ps"
          :key="t"
          :id="`p${t + 1}`"
          :d="`M${i}`"
          :stroke-dasharray="l(i)"
          :stroke-dashoffset="l(i)"
          :style="`animation-delay: ${t * time + time}s;`"
        />
      </g>
      <g>
        <svg:image
          xlink:href="https://liaoning.leziedu.com/cms/webapp/test/h5/static/pen.svg"
          x="0"
          y="-100"
          height="100"
          width="100"
        >
          <animateMotion
            v-for="(i, t) of ps"
            :key="t"
            :dur="`${time}s`"
            :begin="`${time * t}s`"
          >
            <mpath :xlink:href="`#p${t + 1}`" />
          </animateMotion>
        </svg:image>
      </g>
    </svg>
  </view>
</template>

<script>
import { svgPathProperties as pp } from "../g/svg-path-properties.esm.js";

function draw() {
  const svg = `119,136c18-7,38-13,58-17M135,123c1,5,2,10,3,15M158,115c-0-0-0-0-0-0c0,5,1,10,1,15M130,152c12-5,26-9,40-11c-0-0-1-0-2-0M150,133c1,0,1,2,1,4c-4,10-11,20-18,29M143,155c0,4,0,9,1,14M148,154c6-1,12-3,19-4c0,6,1,12,2,18c0,0,0-0,0-1M147,171c6-4,16-5,23-1M213,118c2,18,3,36,2,54c0,0-0,1-0,1c-0,0-0-1,0-0M242,132c-5,7-10,15-15,24M226,139c7,4,13,10,17,18M250,145c5-2,11-2,17-2M279,134c2-1,6-2,8-0c1,1,1,4-0,6c-1,1-4,2-6,3c3-2,8-1,10,2c1,3-0,8-4,10c-4,1-9-1-11-5M305,115c0,18,0,37,0,55M320,141c6-0,13-0,20-1M322,151c6-0,12-1,19-2M354,117c-0,18,1,36,4,54M385,132c-6,3-12,8-16,14c-1,2-3,6-0,8M366,132c10,4,18,12,22,22M401,142c6-0,12-1,18-2M411,130c1,8,2,16,3,25M434,126c-0,9,0,19,2,28M457,111c-1,21-1,42-1,64M483,162c1,4-0,9-4,10M519,138c6-1,12-2,19-3c1,0,0,2-0,2s-1-1-0-2M524,113c5,13,8,28,7,43M518,144c3,2,8,2,12,0M521,156c2-2,5-5,8-8M546,136c-2,4-5,8-9,11M538,147c4,2,8,4,12,7M537,122c2,1,4,3,6,5M580,132c7,5,14,13,18,21M607,121c-1-1-4,0-5,2c-9,11-18,22-28,33M633,149c-2,3,0,9,4,8c4-0,6-7,2-9c-1,0-2,1-3,2M88,237c-2,5-5,10-7,15M86,245c3-2,8-3,12-2c-1,3-4,5-7,7M86,253c0,5,1,11,1,16M84,253c5-1,10-3,16-5c1-0,2-0,3-0c2,0,3,3,4,6c0,7,1,15,2,22M93,257c4-0,8-1,11-2M91,267c4-1,8-2,13-3c0-0,1-0,1-1c0-0-1-0-1,0M98,251c0,7,1,15,1,23M109,242c4-2,9-4,14-4c-0,4-2,9-5,13M114,242c-1,4-3,9-5,13M109,250c1-1,3,1,3,3c-0,2-2,4-1,6M112,256c3-1,7-2,10-3M112,263c4-1,7-3,11-4M117,247c1,10,2,21,2,32M133,257c1-0,3,0,4,2M132,271c1,0,2,0,3,0M194,250c3-2,7-2,10-0c4,3,4,10,7,16M221,239c-11,9-20,21-26,34M219,256c6-2,13-4,20-2M250,240c3-3,10-3,14,0c-3,3-7,6-11,9c3-2,9-0,11,3c1,4,0,9-3,11c-2,2-8,1-8-1M274,251c5-0,11-1,16-2M276,259c6-0,12-1,17-2M305,244c10-0,21,4,26,13c0,0,0,1,0,1c-0,0-1-0-0-0M332,232c-9,8-17,18-22,30M346,248c6-0,11-1,17-2c0-0,1-0,1-1c0-0-1-0-1-0M354,233c0,7,1,15,1,23M378,233c0-1,2,0,2,2c0,8,0,16,0,24M445,236c9-2,18-3,28-4M444,244c2,1,4,3,6,5M447,244c2-2,6-3,10-2c-0,4-3,7-7,8M450,251c2-1,5-3,8-4M447,258c4-1,9-3,12-6M457,224c3,15,13,29,27,36c-0-1-2-2-4-2M461,222c-0-1,0-2,2-2c2,1,4,3,6,5M479,240c-4,6-9,13-14,19M542,239c5-2,12-4,15-0c0,1,1,3,1,4c0,2,0,5,1,7M565,228c-9,7-17,17-23,29M571,242c7-0,15-1,22-2c0-0,1-0,1-1s-1,0-0,0M599,231c3-1,7-2,11-2c1,0,2,0,2,0c2,1,0,5-1,6c-2,1-5,1-7,3c2-1,5-1,7-1c2,0,5,1,6,4c1,4-4,8-8,9c-3,0-6,1-10,1M636,237c3-0,7-1,11-2c0-0,1-0,2,0s-1,0-1,0M635,247c0-0-1-0-0,0c0,0,1,0,1,0c6-0,12-1,18-2c-0-0-1-0-2-1M664,240c5-0,11-1,17-2M708,217c-5,5-11,11-12,19c-1,7,4,17,12,16M712,231c5-0,11-0,16,2c4,2,8,8,5,13M741,223c-10,3-18,12-22,22M746,236c7-1,14-2,21-3c-1-1-3-0-4,0M757,223c0,7,0,15,0,23M783,221c-0,8-0,17-0,26M799,219c0,0-0,0-0-0c0-0,0-0,1,0c4,2,8,4,11,8c3,3,4,8,3,13c-2,6-10,8-15,13M226,344c6-2,12-2,19-1M254,327c4-1,10-0,14,2c-2,4-6,7-10,8c5-2,11,3,10,8s-9,7-13,3M277,336c4-0,9-1,14-2M279,345c5-1,11-2,16-3M310,326c-0,0-0-1,0-1s0,1,0,1c-0,9-1,18-1,28M323,327c5-1,10-3,16-5c-8,5-14,14-18,24M330,335c1,5,1,11,0,16M335,334c3,1,7,4,8,8M349,328c-4,1,11-3,15-3M347,329c0,5,0,11,0,16M348,337c0-2,3-4,5-4c2,0,4,2,4,4c0,2-1,5,0,7M352,315c6,13,13,25,21,37c-0-0-1-0-2-0M359,313c3-0,7,3,6,7M373,330c-5,1-8,6-8,11M380,317c3,0,6,1,8,4M374,328c5-2,10-3,16-3M379,332c3,1,6,4,7,7M391,327c-3,5-5,10-7,15M376,348c8-4,18-5,27-3M554,325c2,0,4-1,7-1c4-0,7,2,9,6c1,3,1,8,1,12c0,0,2,0,1-0M576,318c-4,6-9,12-14,18c-1,1-2,4-0,5M581,331c5-1,10-2,15-3c1-0,3,1,2,1M608,321c2-1,4-3,7-4c2-0,6,2,5,5c-0,1-1,2-2,3c-2,2-5,3-8,5c3-2,10,0,10,4c0,4-5,8-9,6M636,327c5-0,11-1,16-2M641,332c4-0,9-0,14-1M672,329c5-1,10-2,16-3M697,322c4-2,9-1,13,1c3,2,5,8,4,12M721,309c-8,7-16,15-23,25c-0,0-1,1-0,2c0,0,1,1,2,0M727,327c5-1,11-2,17-3M755,311c0,8,1,17,1,26M589,388c-0-3,4-7,8-5s4,6,3,10s-5,5-9,6c5-0,11-1,17-2M613,382c9-2,18,7,16,16M634,378c-0-1-3-0-4,1c-5,6-9,13-13,20M649,385c4-0,9-1,14-3M648,394c6,0,12-0,17-1M678,381c0-1,1-2,2-3c1-1,4-2,6-1c1,0,1,2,1,4c0,6-3,13-9,16c6-1,13-2,20-2M620,439c9-1,17,9,14,17M639,434c-8,6-16,15-20,25M652,443c5-0,11-1,16-2M655,453c0-0-1-0-1,0c0,0,1,0,2,0c4-0,8-1,13-2M682,430c0,8,0,17-0,26c0-0,1-0,1-1M203,519c0-1,3-1,4,0M189,542c2,2,4,5,5,8M219,542c1,1,2,2,3,3M247,513c-1,5-3,9-5,14c3,1,7-0,9-3M253,522c-4,5-7,11-10,18c2,0,5-1,7-3M235,556c0-0,0-0,0-0c5-2,10-5,15-7M258,515c2,1,4,2,5,3M253,524c2,1,4,5,3,8M256,525c5-1,10-3,15-5c1-0,3-0,4,0c0,0,0,1,0,2c-0,3-1,7-1,11M261,531c3-1,7-2,10-3c-0,0-1,1-2,2M256,541c5-3,11-5,17-6M267,538c2,3,3,7,2,11M260,542c-2,0-4,2-4,4c1,1,2,1,4,1M276,542c4-0,7,3,6,7M294,516c2,8,3,18,2,27M298,534c2-2,6-2,9-2M287,549c8-3,16-3,25-2c-0,1,0,2,1,3M320,509c-0-0,0-1,1-0c0,0,0,1-0,2c-2,4-4,8-7,11M315,522c3,6,4,14,2,21M318,528c1-3,4-5,7-5c0-0,1-0,2,0c3,1-2,6-1,10M318,534c3-2,7-4,11-4M338,505c-0-0,0-0,1-0c0,0-0,1-0,1c-2,3-4,6-6,9M333,518c3,8,3,17-0,25M332,522c5-0,10-2,15-5c-0,1-1,1-2,1M340,524c0,7,0,15,0,23M360,525c6-2,12-4,18-7c-0,1-2,2-3,2M370,505c1,12,3,24,5,37c-0,0-1,0-1-0M371,531c-2-0-5,0-5,2c-1,2,0,5,2,6M374,532c4-2,9,1,9,6M381,506c1,1,2,3,3,5M354,528c3,5,3,13-0,18c11-0,22-1,33-2M352,523c1,0,3,0,4,1M394,542c1,3-0,8-4,9M407,525c4-1,9-0,12,2c3,3,4,8,3,12M423,516c-6,8-11,17-15,26M432,527c4-0,9-1,14-1M433,535c4-0,8-0,12-0c1,0,3-0,3-2M461,514c1,9,2,18,2,27`;

  const pt = svg
    .trim()
    .replace(/\.\d+/g, "")
    .split("M")
    .map(i => i.trim());
  this.ps = pt;
}

export default {
  data() {
    return {
      time: 0.1,
      ps: []
    };
  },
  mounted() {
    draw.bind(this)();
  },
  methods: {
    l(m) {
      const p = new pp("M" + m);
      return ~~p.getTotalLength() + 1;
    }
  }
};
</script>

<style>
svg {
  width: 100%;
  max-width: 100%;
  height: auto;
}
path {
  fill: none;
  stroke: #000;
  stroke-width: 3;
  stroke-linecap: round;
  stroke-linejoin: round;
  animation: 0.1s dash;
  animation-fill-mode: forwards;
}

@keyframes dash {
  to {
    stroke-dashoffset: 0;
  }
}
</style>
